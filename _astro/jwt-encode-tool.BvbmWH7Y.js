import{r as d}from"./index.BVOCwoKb.js";import{S as E,C as y}from"./constants.Cg7RhILG.js";import{R as be}from"./resource-utils.C3IEFH3c.js";import{J as A,i as ne,d as ge,e as W,a as P,b as k,c as ve,f as ee,g as Ee}from"./is_object.DTokz0bI.js";var L={exports:{}},H={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te;function je(){if(te)return H;te=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var l in i)l!=="key"&&(o[l]=i[l])}else o=i;return i=o.ref,{$$typeof:t,type:n,key:c,ref:i!==void 0?i:null,props:o}}return H.Fragment=e,H.jsx=r,H.jsxs=r,H}var se;function Ae(){return se||(se=1,L.exports=je()),L.exports}var s=Ae();const f=t=>{const[e,r]=d.useState(!1),[n,i]=d.useState(null),o=()=>{if(navigator?.clipboard?.writeText&&t.text)try{navigator.clipboard.writeText(t.text),r(!0),n&&clearTimeout(n);const c=window.setTimeout(()=>{r(!1)},1e3);i(c)}catch(c){console.error("Failed to copy: ",c)}};return s.jsx("div",{children:s.jsx("div",{className:"tooltip","data-tip":e?"Copied!":"Copy",children:s.jsx("button",{onClick:o,className:"btn btn-ghost btn-info btn-xs px-1 py-2",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:t.size==="sm"?"size-3":"size-4",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"})})})})})};function x(t,e="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${e} must be ${t}`)}function J(t,e){return t.name===e}function B(t){return parseInt(t.name.slice(4),10)}function Ce(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function Te(t,e){if(!t.usages.includes(e))throw new TypeError(`CryptoKey does not support this operation, its usages must include ${e}.`)}function Ne(t,e,r){switch(e){case"HS256":case"HS384":case"HS512":{if(!J(t.algorithm,"HMAC"))throw x("HMAC");const n=parseInt(e.slice(2),10);if(B(t.algorithm.hash)!==n)throw x(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!J(t.algorithm,"RSASSA-PKCS1-v1_5"))throw x("RSASSA-PKCS1-v1_5");const n=parseInt(e.slice(2),10);if(B(t.algorithm.hash)!==n)throw x(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!J(t.algorithm,"RSA-PSS"))throw x("RSA-PSS");const n=parseInt(e.slice(2),10);if(B(t.algorithm.hash)!==n)throw x(`SHA-${n}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":{if(!J(t.algorithm,"Ed25519"))throw x("Ed25519");break}case"ES256":case"ES384":case"ES512":{if(!J(t.algorithm,"ECDSA"))throw x("ECDSA");const n=Ce(e);if(t.algorithm.namedCurve!==n)throw x(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}Te(t,r)}function ie(t,e,...r){if(r=r.filter(Boolean),r.length>2){const n=r.pop();t+=`one of type ${r.join(", ")}, or ${n}.`}else r.length===2?t+=`one of type ${r[0]} or ${r[1]}.`:t+=`of type ${r[0]}.`;return e==null?t+=` Received ${e}`:typeof e=="function"&&e.name?t+=` Received function ${e.name}`:typeof e=="object"&&e!=null&&e.constructor?.name&&(t+=` Received an instance of ${e.constructor.name}`),t}const Ke=(t,...e)=>ie("Key must be ",t,...e);function ae(t,e,...r){return ie(`Key for the ${t} algorithm must be `,e,...r)}function oe(t){return t?.[Symbol.toStringTag]==="CryptoKey"}function ce(t){return t?.[Symbol.toStringTag]==="KeyObject"}const le=t=>oe(t)||ce(t),Pe=(...t)=>{const e=t.filter(Boolean);if(e.length===0||e.length===1)return!0;let r;for(const n of e){const i=Object.keys(n);if(!r||r.size===0){r=new Set(i);continue}for(const o of i){if(r.has(o))return!1;r.add(o)}}return!0},He=(t,e)=>{if(t.startsWith("RS")||t.startsWith("PS")){const{modulusLength:r}=e.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}};function Je(t){let e,r;switch(t.kty){case"RSA":{switch(t.alg){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${t.alg.slice(-3)}`},r=t.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(t.alg.slice(-3),10)||1}`},r=t.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(t.alg){case"ES256":e={name:"ECDSA",namedCurve:"P-256"},r=t.d?["sign"]:["verify"];break;case"ES384":e={name:"ECDSA",namedCurve:"P-384"},r=t.d?["sign"]:["verify"];break;case"ES512":e={name:"ECDSA",namedCurve:"P-521"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:"ECDH",namedCurve:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(t.alg){case"Ed25519":case"EdDSA":e={name:"Ed25519"},r=t.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":e={name:t.crv},r=t.d?["deriveBits"]:[];break;default:throw new A('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new A('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:e,keyUsages:r}}const We=async t=>{if(!t.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:e,keyUsages:r}=Je(t),n={...t};return delete n.alg,delete n.use,crypto.subtle.importKey("jwk",n,e,t.ext??!t.d,t.key_ops??r)},Re=(t,e,r,n,i)=>{if(i.crit!==void 0&&n?.crit===void 0)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(c=>typeof c!="string"||c.length===0))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;r!==void 0?o=new Map([...Object.entries(r),...e.entries()]):o=e;for(const c of n.crit){if(!o.has(c))throw new A(`Extension Header Parameter "${c}" is not recognized`);if(i[c]===void 0)throw new t(`Extension Header Parameter "${c}" is missing`);if(o.get(c)&&n[c]===void 0)throw new t(`Extension Header Parameter "${c}" MUST be integrity protected`)}return new Set(n.crit)};function z(t){return ne(t)&&typeof t.kty=="string"}function De(t){return t.kty!=="oct"&&typeof t.d=="string"}function Ie(t){return t.kty!=="oct"&&typeof t.d>"u"}function Me(t){return t.kty==="oct"&&typeof t.k=="string"}let C;const re=async(t,e,r,n=!1)=>{C||=new WeakMap;let i=C.get(t);if(i?.[r])return i[r];const o=await We({...e,alg:r});return n&&Object.freeze(t),i?i[r]=o:C.set(t,{[r]:o}),o},$e=(t,e)=>{C||=new WeakMap;let r=C.get(t);if(r?.[e])return r[e];const n=t.type==="public",i=!!n;let o;if(t.asymmetricKeyType==="x25519"){switch(e){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}o=t.toCryptoKey(t.asymmetricKeyType,i,n?[]:["deriveBits"])}if(t.asymmetricKeyType==="ed25519"){if(e!=="EdDSA"&&e!=="Ed25519")throw new TypeError("given KeyObject instance cannot be used for this algorithm");o=t.toCryptoKey(t.asymmetricKeyType,i,[n?"verify":"sign"])}if(t.asymmetricKeyType==="rsa"){let c;switch(e){case"RSA-OAEP":c="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":c="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":c="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":c="SHA-512";break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}if(e.startsWith("RSA-OAEP"))return t.toCryptoKey({name:"RSA-OAEP",hash:c},i,n?["encrypt"]:["decrypt"]);o=t.toCryptoKey({name:e.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:c},i,[n?"verify":"sign"])}if(t.asymmetricKeyType==="ec"){const l=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(t.asymmetricKeyDetails?.namedCurve);if(!l)throw new TypeError("given KeyObject instance cannot be used for this algorithm");e==="ES256"&&l==="P-256"&&(o=t.toCryptoKey({name:"ECDSA",namedCurve:l},i,[n?"verify":"sign"])),e==="ES384"&&l==="P-384"&&(o=t.toCryptoKey({name:"ECDSA",namedCurve:l},i,[n?"verify":"sign"])),e==="ES512"&&l==="P-521"&&(o=t.toCryptoKey({name:"ECDSA",namedCurve:l},i,[n?"verify":"sign"])),e.startsWith("ECDH-ES")&&(o=t.toCryptoKey({name:"ECDH",namedCurve:l},i,n?[]:["deriveBits"]))}if(!o)throw new TypeError("given KeyObject instance cannot be used for this algorithm");return r?r[e]=o:C.set(t,{[e]:o}),o},ke=async(t,e)=>{if(t instanceof Uint8Array||oe(t))return t;if(ce(t)){if(t.type==="secret")return t.export();if("toCryptoKey"in t&&typeof t.toCryptoKey=="function")try{return $e(t,e)}catch(n){if(n instanceof TypeError)throw n}let r=t.export({format:"jwk"});return re(t,r,e)}if(z(t))return t.k?ge(t.k):re(t,t,e,!0);throw new Error("unreachable")},j=t=>t?.[Symbol.toStringTag],U=(t,e,r)=>{if(e.use!==void 0){let n;switch(r){case"sign":case"verify":n="sig";break;case"encrypt":case"decrypt":n="enc";break}if(e.use!==n)throw new TypeError(`Invalid key for this operation, its "use" must be "${n}" when present`)}if(e.alg!==void 0&&e.alg!==t)throw new TypeError(`Invalid key for this operation, its "alg" must be "${t}" when present`);if(Array.isArray(e.key_ops)){let n;switch(!0){case r==="sign":case t==="dir":case t.includes("CBC-HS"):n=r;break;case t.startsWith("PBES2"):n="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(t):!t.includes("GCM")&&t.endsWith("KW")?n="unwrapKey":n=r;break;case r==="encrypt":n="wrapKey";break;case r==="decrypt":n=t.startsWith("RSA")?"unwrapKey":"deriveBits";break}if(n&&e.key_ops?.includes?.(n)===!1)throw new TypeError(`Invalid key for this operation, its "key_ops" must include "${n}" when present`)}return!0},Le=(t,e,r)=>{if(!(e instanceof Uint8Array)){if(z(e)){if(Me(e)&&U(t,e,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!le(e))throw new TypeError(ae(t,e,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if(e.type!=="secret")throw new TypeError(`${j(e)} instances for symmetric algorithms must be of type "secret"`)}},Be=(t,e,r)=>{if(z(e))switch(r){case"decrypt":case"sign":if(De(e)&&U(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if(Ie(e)&&U(t,e,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!le(e))throw new TypeError(ae(t,e,"CryptoKey","KeyObject","JSON Web Key"));if(e.type==="secret")throw new TypeError(`${j(e)} instances for asymmetric algorithms must not be of type "secret"`);if(e.type==="public")switch(r){case"sign":throw new TypeError(`${j(e)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw new TypeError(`${j(e)} instances for asymmetric algorithm decryption must be of type "private"`)}if(e.type==="private")switch(r){case"verify":throw new TypeError(`${j(e)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw new TypeError(`${j(e)} instances for asymmetric algorithm encryption must be of type "public"`)}},Oe=(t,e,r)=>{t.startsWith("HS")||t==="dir"||t.startsWith("PBES2")||/^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(t)||/^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(t)?Le(t,e,r):Be(t,e,r)},Ue=(t,e)=>{const r=`SHA-${t.slice(-3)}`;switch(t){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:parseInt(t.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:e.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};default:throw new A(`alg ${t} is not supported either by JOSE or your javascript runtime`)}},ze=async(t,e,r)=>{if(e instanceof Uint8Array){if(!t.startsWith("HS"))throw new TypeError(Ke(e,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",e,{hash:`SHA-${t.slice(-3)}`,name:"HMAC"},!1,[r])}return Ne(e,t,r),e},g=t=>Math.floor(t.getTime()/1e3),de=60,ue=de*60,_=ue*24,_e=_*7,Fe=_*365.25,Ve=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,O=t=>{const e=Ve.exec(t);if(!e||e[4]&&e[1])throw new TypeError("Invalid time period format");const r=parseFloat(e[2]),n=e[3].toLowerCase();let i;switch(n){case"sec":case"secs":case"second":case"seconds":case"s":i=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":i=Math.round(r*de);break;case"hour":case"hours":case"hr":case"hrs":case"h":i=Math.round(r*ue);break;case"day":case"days":case"d":i=Math.round(r*_);break;case"week":case"weeks":case"w":i=Math.round(r*_e);break;default:i=Math.round(r*Fe);break}return e[1]==="-"||e[4]==="ago"?-i:i};function v(t,e){if(!Number.isFinite(e))throw new TypeError(`Invalid ${t} input`);return e}class qe{#e;constructor(e){if(!ne(e))throw new TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(e)}data(){return W.encode(JSON.stringify(this.#e))}get iss(){return this.#e.iss}set iss(e){this.#e.iss=e}get sub(){return this.#e.sub}set sub(e){this.#e.sub=e}get aud(){return this.#e.aud}set aud(e){this.#e.aud=e}set jti(e){this.#e.jti=e}set nbf(e){typeof e=="number"?this.#e.nbf=v("setNotBefore",e):e instanceof Date?this.#e.nbf=v("setNotBefore",g(e)):this.#e.nbf=g(new Date)+O(e)}set exp(e){typeof e=="number"?this.#e.exp=v("setExpirationTime",e):e instanceof Date?this.#e.exp=v("setExpirationTime",g(e)):this.#e.exp=g(new Date)+O(e)}set iat(e){typeof e>"u"?this.#e.iat=g(new Date):e instanceof Date?this.#e.iat=v("setIssuedAt",g(e)):typeof e=="string"?this.#e.iat=v("setIssuedAt",g(new Date)+O(e)):this.#e.iat=v("setIssuedAt",e)}}const Ge=async(t,e,r)=>{const n=await ze(t,e,"sign");He(t,n);const i=await crypto.subtle.sign(Ue(t,n.algorithm),n,r);return new Uint8Array(i)};class Ye{#e;#t;#s;constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this.#e=e}setProtectedHeader(e){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setUnprotectedHeader(e){if(this.#s)throw new TypeError("setUnprotectedHeader can only be called once");return this.#s=e,this}async sign(e,r){if(!this.#t&&!this.#s)throw new P("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Pe(this.#t,this.#s))throw new P("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const n={...this.#t,...this.#s},i=Re(P,new Map([["b64",!0]]),r?.crit,this.#t,n);let o=!0;if(i.has("b64")&&(o=this.#t.b64,typeof o!="boolean"))throw new P('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:c}=n;if(typeof c!="string"||!c)throw new P('JWS "alg" (Algorithm) Header Parameter missing or invalid');Oe(c,e,"sign");let l=this.#e;o&&(l=W.encode(k(l)));let p;this.#t?p=W.encode(k(JSON.stringify(this.#t))):p=W.encode("");const R=ve(p,W.encode("."),l),S=await ke(e,c),D=await Ge(c,S,R),m={signature:k(D),payload:""};return o&&(m.payload=ee.decode(l)),this.#s&&(m.header=this.#s),this.#t&&(m.protected=ee.decode(p)),m}}class Ze{#e;constructor(e){this.#e=new Ye(e)}setProtectedHeader(e){return this.#e.setProtectedHeader(e),this}async sign(e,r){const n=await this.#e.sign(e,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}class Xe{#e;#t;constructor(e={}){this.#t=new qe(e)}setIssuer(e){return this.#t.iss=e,this}setSubject(e){return this.#t.sub=e,this}setAudience(e){return this.#t.aud=e,this}setJti(e){return this.#t.jti=e,this}setNotBefore(e){return this.#t.nbf=e,this}setExpirationTime(e){return this.#t.exp=e,this}setIssuedAt(e){return this.#t.iat=e,this}setProtectedHeader(e){return this.#e=e,this}async sign(e,r){const n=new Ze(this.#t.data());if(n.setProtectedHeader(this.#e),Array.isArray(this.#e?.crit)&&this.#e.crit.includes("b64")&&this.#e.b64===!1)throw new Ee("JWTs MUST NOT use unencoded payload");return n.sign(e,r)}}const Qe=t=>s.jsx("div",{children:s.jsx("div",{className:"tooltip","data-tip":"Switch",children:s.jsx("button",{onClick:t.onSwitch,className:"btn btn-ghost btn-info btn-xs px-1 py-2",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-4",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})})})})}),he=["HS256","HS384","HS512"],et=t=>{const{alg:e,onChange:r}=t,n=i=>{const o=i.target.value;r(o)};return s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Algorithm",s.jsx(f,{text:e,size:"sm"})]}),s.jsx("select",{className:"select w-full border-sky-900 focus:outline-2 focus:outline-sky-700",value:e,onChange:n,children:he.map(i=>s.jsx("option",{value:i,children:i},i))})]})},tt=t=>{try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}},st=()=>({payload:JSON.stringify({test:"test"},null,2),alg:he[0],secret:crypto.randomUUID().toString(),issuedAt:!0,audience:"test",issuer:"test",jti:"",subject:"",notBefore:"",expirationTime:new Date(Date.now()+1e3*60*60).toISOString().slice(0,19)}),h={safeJsonFormat:tt,getDefaults:st},ot=()=>{const[t,e]=d.useState(()=>h.getDefaults().payload),[r,n]=d.useState(()=>h.getDefaults().alg),[i,o]=d.useState(()=>h.getDefaults().secret),[c,l]=d.useState(()=>h.getDefaults().issuedAt),[p,R]=d.useState(()=>h.getDefaults().audience),[S,D]=d.useState(()=>h.getDefaults().issuer),[m,F]=d.useState(()=>h.getDefaults().jti),[T,V]=d.useState(()=>h.getDefaults().subject),[N,q]=d.useState(()=>h.getDefaults().notBefore),[K,G]=d.useState(()=>h.getDefaults().expirationTime),[fe,M]=d.useState(""),[Y,Z]=d.useState(""),[I,$]=d.useState([]),[b,X]=d.useState(!1),pe=()=>{X(!b),E.toggleJsonArrayItem(y.ToolLayout.ExpandedKey,y.ToolId.JwtEncode,!b)};d.useEffect(()=>{const a=E.loadJsonArray(y.ToolLayout.ExpandedKey),w=E.loadJsonArray(y.ToolId.JwtEncode);X(a.includes(y.ToolId.JwtEncode)),$(w)},[]);const me=a=>{const w=E.loadJsonArray(y.ToolId.JwtEncode),u=[a,...w].slice(0,y.History.Max);$(u),E.saveJsonArray(y.ToolId.JwtEncode,u)},ye=()=>{$([]),E.removeJsonArray(y.ToolId.JwtEncode)},xe=a=>{Z(a.encoded),e(a.payload),n(a.alg),o(a.secret),l(a.issuedAt),R(a.audience),D(a.issuer),F(a.jti),V(a.subject),q(a.notBefore),G(a.expirationTime),M("")},we=async a=>{e(h.safeJsonFormat(a)),!a||a.trim()},Se=async()=>{try{const a=JSON.parse(t),w=new TextEncoder().encode(i),u=new Xe(a).setProtectedHeader({alg:r,typ:"JWT"});c&&u.setIssuedAt(),p&&u.setAudience(p),S&&u.setIssuer(S),m&&u.setJti(m),T&&u.setSubject(T),N&&u.setNotBefore(new Date(N)),K&&u.setExpirationTime(new Date(K));const Q=await u.sign(w);Z(Q),M(""),me({encoded:Q,payload:t,alg:r,secret:i,issuedAt:c,audience:p,issuer:S,jti:m,subject:T,notBefore:N,expirationTime:K,date:new Date().toISOString()})}catch{M("Invalid JWT")}};return s.jsx("div",{className:`card card-border w-full h-fit transition-all duration-500 ease-out overflow-hidden bg-inherit 
				 bg-gradient-to-br from-sky-500/20 via-sky-900/20 to-transparent border-sky-900/70 
				${b?"md:w-2xl h-[1300px]":"md:w-sm h-[140px]"}`,children:s.jsxs("div",{className:"card-body",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"card-title lg:text-2xl sm:text-xl text-lg",children:"Jwt encode"}),s.jsxs("button",{onClick:pe,className:"btn btn-ghost btn-info btn-xs px-1 py-2",children:[b&&s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-4",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"})}),!b&&s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-4",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"})})]})]}),s.jsxs("div",{className:`transition-all duration-500 ease-out
						${b?"opacity-100 max-h-[1200px]":"opacity-0 max-h-0 overflow-hidden"}`,children:[s.jsxs("div",{className:"flex justify-between flex-col gap-2",children:[s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-legend",children:["Encoded",s.jsx(f,{text:Y})]}),s.jsx("textarea",{disabled:!0,value:Y,placeholder:"Enter JWT to decode",style:{color:"white",cursor:"text"},className:"textarea textarea-lg textarea-primary w-full h-20"}),s.jsx("div",{className:"fieldset-label text-error",children:fe})]}),s.jsxs("div",{className:"flex justify-between gap-2 h-full flex-wrap sm:flex-nowrap",children:[s.jsxs("div",{className:"flex flex-col gap-1 w-1/2 flex-grow",children:[s.jsx(et,{alg:r,onChange:n}),s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Secret",s.jsx(f,{text:i,size:"sm"})]}),s.jsx("input",{value:i,onInput:a=>o(a.currentTarget.value),placeholder:"Secret",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("fieldset",{className:"fieldset flex-grow flex",children:[s.jsxs("legend",{className:"fieldset-label",children:["Payload",s.jsx(f,{text:t,size:"sm"})]}),s.jsx("textarea",{value:t,onInput:a=>we(a.currentTarget.value),placeholder:"Body (JSON)",className:"textarea textarea-lg textarea-primary w-full min-h-[100px] h-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]})]}),s.jsxs("div",{className:"flex flex-col gap-1 w-1/2 flex-grow",children:[s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Audience (aud)",s.jsx(f,{text:p,size:"sm"})]}),s.jsx("input",{value:p,onInput:a=>R(a.currentTarget.value),placeholder:"Audience",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Issuer (iss)",s.jsx(f,{text:S,size:"sm"})]}),s.jsx("input",{value:S,onInput:a=>D(a.currentTarget.value),placeholder:"Issuer",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Subject (sub)",s.jsx(f,{text:T,size:"sm"})]}),s.jsx("input",{value:T,onInput:a=>V(a.currentTarget.value),placeholder:"Subject",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Jti",s.jsx(f,{text:m,size:"sm"})]}),s.jsx("input",{value:m,onInput:a=>F(a.currentTarget.value),placeholder:"Jti",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Expiration time (exp)",s.jsx(f,{text:K,size:"sm"})]}),s.jsx("input",{value:K,onInput:a=>G(a.currentTarget.value),type:"datetime-local",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("fieldset",{className:"fieldset",children:[s.jsxs("legend",{className:"fieldset-label",children:["Not before (nbf)",s.jsx(f,{text:N,size:"sm"})]}),s.jsx("input",{value:N,onInput:a=>q(a.currentTarget.value),type:"datetime-local",className:"input input-primary w-full border-sky-900 focus:outline-2 focus:outline-sky-700"})]}),s.jsxs("div",{className:"flex justify-between w-full",children:[s.jsxs("label",{className:"fieldset",children:[s.jsx("legend",{className:"fieldset-label",children:"Issued at (iat)"}),s.jsx("input",{type:"checkbox",className:"checkbox",checked:c,onChange:a=>l(a.currentTarget.checked)})]}),s.jsxs("label",{className:"fieldset",children:[s.jsx("legend",{className:"fieldset-label",children:"Generate"}),s.jsx("button",{onClick:Se,className:"btn btn-soft btn-info btn-sm",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]})]})]})]})]}),s.jsxs("div",{className:"flex justify-between items-center mt-4",children:[s.jsxs("h3",{className:"text-lg",children:["History (",I.length,"/",y.History.Max,")"]}),s.jsx("button",{onClick:ye,className:"btn btn-ghost btn-error btn-sm px-1 py-2",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-4",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})})})]}),s.jsx("div",{className:"overflow-auto max-h-[200px]",children:s.jsxs("table",{className:"table table-pin-rows table-zebra",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2",children:"#"}),s.jsx("th",{className:"p-2",children:"Swc"}),s.jsx("th",{className:"p-2",children:"Copy"}),s.jsx("th",{className:"p-2",children:"Token"})]})}),s.jsxs("tbody",{children:[I.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"text-center",children:"No history items"})}),I.map((a,w)=>s.jsxs("tr",{children:[s.jsx("td",{className:"text-left p-2",children:s.jsx("div",{className:"tooltip tooltip-right","data-tip":new Date(a.date).toLocaleString(),children:s.jsx("kbd",{className:"kbd",children:I.length-w})})}),s.jsx("td",{className:"text-left p-2",children:s.jsx(Qe,{onSwitch:()=>xe(a)})}),s.jsx("td",{className:"text-left p-2",children:s.jsx(f,{text:a.encoded})}),s.jsx("td",{className:"p-2 break-keep text-nowrap",children:s.jsx("p",{children:a.encoded})})]},w))]})]})})]}),s.jsx("div",{className:`transition-all duration-500 ease-out 
						${b?"opacity-0 max-h-0 overflow-hidden":"opacity-100 max-h-[80px]"}`,children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"mb-2 text-sm opacity-70",children:"Jwt encoding tool"}),s.jsxs("div",{className:"flex items-end justify-center rounded-lg p-2",children:[s.jsx("span",{className:"text-xs opacity-70 mr-2",children:"Built with"}),s.jsx("div",{className:"tooltip tooltip-top","data-tip":"React",children:s.jsx("a",{href:"https://react.dev",target:"_blank",rel:"noopener noreferrer",children:s.jsx("img",{src:be.getLogo("react"),alt:"React",loading:"lazy",decoding:"async",width:"20",height:"20",className:"inline"})})})]})]})})]})})};export{ot as default};
